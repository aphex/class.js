(function(){var l=this,d=l._;!d&&"undefined"!==typeof require&&(d=require("underscore"));var q=l.Class,i;i="undefined"!==typeof exports?exports:l.Class={};i.VERSION="0.2.0";i.noConflict=function(){l.Class=q;return this};var o=function(){};d.extend(i,{types:{String:d.isString,Number:d.isNumber,Boolean:d.isBoolean,Array:d.isArray,Function:d.isFunction,Object:d.isObject,Element:d.isElement,Regex:d.isRegExp},_extend:function(d){return i.define(this,d)},define:function(f,c){d.isFunction(f)||(c=f,f=null);
var b=c&&c.hasOwnProperty("constructor")?c.constructor:null,a=function(){if(!(this instanceof a))throw Error("Use new keyword to create a new instance");b?b.apply(this,arguments):f&&f.apply(this,arguments)};f&&(o.prototype=f.prototype,a.prototype=new o,a.constructor=a,a.prototype.__super__=f.prototype);if(c){c.singleton&&(a.$$instance=null,a.getInstance=function(){return this.$$instance||(this.$$instance=new this)});var g=c.mixins;if(g)for(var e=0,m=g.length;e<m;e++){var r=d.isFunction(g[e])?g[e].prototype:
g[e];d.extend(a.prototype,r)}if(e=c.properties)for(var k in e)i._createProperty(a,k,e[k]);a.prototype.set=function(c){for(var b in c){var a="set"+(b.charAt(0).toUpperCase()+b.substring(1));if(this[a])this[a](c[b]);else throw Error('No public set method for property "'+b+'" found.');}return this};d.extend(a.prototype,c.members);d.extend(a,c.statics);if(k=c.interfaces){e=0;for(m=k.length;e<m;e++){var g=d.isFunction(k[e])?k[e].prototype:k[e],h;for(h in g)if(!a.prototype[h])throw Error('The Class does not implement the interface member "'+
h+'"');}}a.prototype.$$error=c.error||i.error}a.extend=i._extend;a.prototype.instanceOf=i._instanceOf;return a},_instanceOf:function(d){return this instanceof d},error:function(d,c,b,a){throw Error(a);},_createProperty:function(f,c,b){var a=c.charAt(0).toUpperCase()+c.substring(1),g="get"+a;!1===b.get&&(g="_"+g);var e="set"+a;!1===b.set&&(e="_"+e);f.prototype[e]=function(a,e){var e=!0===e?!0:!1,f=this[g]();if(b.format){var h=d.isString(b.format)?this[b.format]:b.format;if(h)a=h.call(this,a,f,c);else throw Error('Format method "'+
b.format+'" for property "'+c+'" not available.');}var j=b.type;if(!(d.isNull(a)&&!0===b.nullable)&&j)if(h=d.isFunction(j)?this.instanceOf:i.types[j]){if(!h.call(this,a)){f='Wrong type for property "'+c+'". Expected value "'+a+'" to be of type "'+j+'" but found: '+typeof a;this.$$error.call(this,new n(f,c,a));return}}else throw Error('Unknown type "'+j+'" for property "'+c+'".');if(b.validate)if(h=d.isString(b.validate)?this[b.validate]:b.validate){if(!h.call(this,a,f,c)){f='Validation for property "'+
c+'" with value "'+a+'" failed';this.$$error.call(this,new p(f,c,a,j));return}}else throw Error('Validation method "'+b.validate+'" for property "'+c+'" not available.');this.$$properties[c]=a;if(b.apply)if(h=d.isString(b.apply)?this[b.apply]:b.apply)h.call(this,a,f,c);else throw Error('Apply method "'+b.apply+'" for property "'+c+'" not available.');if(b.event&&e)if(j=this.trigger||this.emit)j.call(this,b.event,{target:this,value:a,old:f,property:c});else throw Error("Object does not support events");
return a};f.prototype[g]=function(){this.$$properties=this.$$properties||{};"undefined"!==typeof b.init&&(this.$$properties[c]=b.init,delete b.init);return this.$$properties[c]};"Boolean"===b.type&&(a="is"+a,!1===b.get&&(a="_"+a),f.prototype[a]=function(){return this[g]()})},ValidationError:n,TypeError:p});var n=i.define(Error,{constructor:function(d,c,b){this.name="ValidationError";this.message=d||"Validation Error";this.property=c;this.value=b}}),p=n.extend({constructor:function(d,c,b,a){this.__super__.apply(arguments);
this.name="TypeError";this.message=d||"Type Error";this.type=a}})}).call(this);