(function(){var l=this,d=l._;!d&&"undefined"!==typeof require&&(d=require("underscore"));var q=l.Class,i;i="undefined"!==typeof exports?exports:l.Class={};i.VERSION="0.2.1-pre";i.noConflict=function(){l.Class=q;return this};var o=function(){};d.extend(i,{types:{String:d.isString,Number:d.isNumber,Boolean:d.isBoolean,Array:d.isArray,Function:d.isFunction,Object:d.isObject,Element:d.isElement,Regex:d.isRegExp},_extend:function(d){return i.define(this,d)},define:function(f,b){d.isFunction(f)||(b=f,f=
null);var c=b&&b.hasOwnProperty("constructor")?b.constructor:null,a=function(){if(!(this instanceof a))throw Error("Use new keyword to create a new instance");c?c.apply(this,arguments):f&&f.apply(this,arguments)};f&&(o.prototype=f.prototype,a.prototype=new o,a.constructor=a,a.prototype.__super__=f.prototype);if(b){b.singleton&&(a.$$instance=null,a.getInstance=function(){return this.$$instance||(this.$$instance=new this)});var h=b.mixins;if(h)for(var e=0,m=h.length;e<m;e++){var r=d.isFunction(h[e])?
h[e].prototype:h[e];d.extend(a.prototype,r)}if(e=b.properties)for(var k in e)i._createProperty(a,k,e[k]);a.prototype.set=function(b){for(var c in b){var a="set"+(c.charAt(0).toUpperCase()+c.substring(1));if(this[a])this[a](b[c]);else throw Error('No public set method for property "'+c+'" found.');}return this};d.extend(a.prototype,b.members);d.extend(a,b.statics);if(k=b.interfaces){e=0;for(m=k.length;e<m;e++){var h=d.isFunction(k[e])?k[e].prototype:k[e],g;for(g in h)if(!a.prototype[g])throw Error('The Class does not implement the interface member "'+
g+'"');}}g=i.error;b.error&&(g=d.isString(b.error)?a.prototype[b.error]:b.error);a.prototype.$$error=g}a.extend=i._extend;a.prototype.instanceOf=i._instanceOf;return a},_instanceOf:function(d){return this instanceof d},error:function(d,b,c,a){throw Error(a);},_createProperty:function(f,b,c){var a=b.charAt(0).toUpperCase()+b.substring(1),h="get"+a;!1===c.get&&(h="_"+h);var e="set"+a;!1===c.set&&(e="_"+e);f.prototype[e]=function(a,e){var e=!0===e?!0:!1,f=this[h]();if(c.format){var g=d.isString(c.format)?
this[c.format]:c.format;if(g)a=g.call(this,a,f,b);else throw Error('Format method "'+c.format+'" for property "'+b+'" not available.');}var j=c.type;if(!(d.isNull(a)&&!0===c.nullable)&&j)if(g=d.isFunction(j)?this.instanceOf:i.types[j]){if(!g.call(this,a)){f='Wrong type for property "'+b+'". Expected value "'+a+'" to be of type "'+j+'" but found: '+typeof a;this.$$error.call(this,new n(f,b,a));return}}else throw Error('Unknown type "'+j+'" for property "'+b+'".');if(c.validate)if(g=d.isString(c.validate)?
this[c.validate]:c.validate){if(!g.call(this,a,f,b)){f='Validation for property "'+b+'" with value "'+a+'" failed';this.$$error.call(this,new p(f,b,a,j));return}}else throw Error('Validation method "'+c.validate+'" for property "'+b+'" not available.');this.$$properties[b]=a;if(c.apply)if(g=d.isString(c.apply)?this[c.apply]:c.apply)g.call(this,a,f,b);else throw Error('Apply method "'+c.apply+'" for property "'+b+'" not available.');if(c.event&&e)if(j=this.trigger||this.emit)j.call(this,c.event,{target:this,
value:a,old:f,property:b});else throw Error("Object does not support events");return a};f.prototype[h]=function(){this.$$properties=this.$$properties||{};"undefined"!==typeof c.init&&(this.$$properties[b]=c.init,delete c.init);return this.$$properties[b]};"Boolean"===c.type&&(a="is"+a,!1===c.get&&(a="_"+a),f.prototype[a]=function(){return this[h]()})},ValidationError:n,TypeError:p});var n=i.define(Error,{constructor:function(d,b,c){this.name="ValidationError";this.message=d||"Validation Error";this.property=
b;this.value=c}}),p=n.extend({constructor:function(d,b,c,a){this.__super__.apply(arguments);this.name="TypeError";this.message=d||"Type Error";this.type=a}})}).call(this);